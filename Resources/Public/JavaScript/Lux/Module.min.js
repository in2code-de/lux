import"@in2code/lux/Diagram.min.js";import"@in2code/lux/PageOverview.min.js";let LuxBackend=function(){var l=this,e=(this.initialize=function(){e("leadlistdetail","visitor"),e("companydetail","company"),e("analysiscontentdetailpage","page"),e("analysisnewsdetailpage","news"),e("analysisutmdetailpage","visitor"),e("analysissearchdetailpage","searchterm"),e("analysiscontentdetaildownload","download"),e("analysislinklistenerdetail","linkListener"),e("workflowdetail","workflow","luxenterprise"),e("abtestingdetail","abTesting","luxenterprise"),e("workflowurlshortenerdetail","urlShortener","luxenterprise"),t(),n(),a(),i(),o(),r(),u(),c(),s(),d(),m(),g(),x(),f(),v()},function(t,n,a){a=a||"lux";for(var i=document.querySelectorAll("[data-lux-action-"+t+"]"),e=0;e<i.length;e++)i[e].addEventListener("click",function(){y(i,"lux-action-detail"),this.classList.add("lux-action-detail");var e={};e[n]=this.getAttribute("data-lux-action-"+t),h(TYPO3.settings.ajaxUrls["/"+a+"/"+t],e,"generalDetailCallback")})}),t=function(){var e=document.querySelector('[data-lux-container="detail"]');null!==e&&e.addEventListener("click",function(n){n=n.target;if(null!==n.getAttribute("data-lux-description")){n.classList.contains("lux-textarea__default")&&(n.classList.remove("lux-textarea__default"),n.value="");let[e,t]=n.getAttribute("data-lux-description").split(":");n.addEventListener("blur",function(){"visitor"===e&&h(TYPO3.settings.ajaxUrls["/lux/visitordescription"],{visitor:t,value:this.value},null),"company"===e&&h(TYPO3.settings.ajaxUrls["/lux/companydescription"],{company:t,value:this.value},null)})}})},n=function(){var t,e=document.querySelector("[data-lux-visitor-company]");null!==e&&(t=e.getAttribute("data-lux-visitor-company"),e.addEventListener("change",function(e){h(TYPO3.settings.ajaxUrls["/lux/visitorcompany"],{visitor:t,value:this.value},"reloadCallback")}))},a=function(){var t,e=document.querySelector("[data-lux-company-category]");null!==e&&(t=e.getAttribute("data-lux-company-category"),e.addEventListener("change",function(e){h(TYPO3.settings.ajaxUrls["/lux/companycategory"],{company:t,value:this.value})}))},i=(this.reloadCallback=function(e){location.reload()},function(){var e=document.querySelector('[data-lux-container="detail"]');null!==e&&e.addEventListener("click",function(e){var e=e.target;null!==e.getAttribute("data-lux-linkmock-event")&&(e=e.getAttribute("data-lux-linkmock-event"),null!==(e=document.querySelector('[data-lux-linkmock-link="'+e+'"]')))&&e.click()})}),o=(this.generalDetailCallback=function(e){document.querySelector('[data-lux-container="detail"]').innerHTML=e.html,r(),n(),a(),window.LuxDiagramObject.initialize()},function(){for(var e=document.querySelectorAll("[data-lux-confirm]"),t=0;t<e.length;t++)e[t].addEventListener("click",function(e){var t=e.currentTarget.getAttribute("data-lux-confirm");!1===confirm(t)&&e.preventDefault()})});let r=function(e){var t=(e=e||document).querySelectorAll("[data-lux-asynchronous-image],[data-lux-asynchronous-companyimage]");for(let e=0;e<t.length;e++){var n=t[e].getAttribute("data-lux-asynchronous-image"),n=(null!==n&&h(TYPO3.settings.ajaxUrls["/lux/visitorimage"],{visitor:n},"asynchronousImageLoadingCallback",{element:t[e]}),t[e].getAttribute("data-lux-asynchronous-companyimage"));null!==n&&h(TYPO3.settings.ajaxUrls["/lux/companyimage"],{company:n},"asynchronousImageLoadingCallback",{element:t[e]})}},u=(this.asynchronousImageLoadingCallback=function(e,t){t.element instanceof HTMLImageElement&&t.element.setAttribute("src",e.url)},function(){document.querySelectorAll("[data-lux-getlinklistenerperformance]").forEach(function(e){var t=e.getAttribute("data-lux-getlinklistenerperformance");0<t&&h(TYPO3.settings.ajaxUrls["/lux/linklistenerperformance"],{linkListener:t},"asynchronousLinkListenerPerformanceLoadingCallback",{element:e})})}),c=(this.asynchronousLinkListenerPerformanceLoadingCallback=function(e,t){e=(100*e.performance).toFixed(1);t.element.innerHTML=e+" %"},function(){document.querySelectorAll("[data-lux-getcompaniesinformation-numberofvisits]").forEach(function(e){var t=e.getAttribute("data-lux-getcompaniesinformation-numberofvisits");0<t&&h(TYPO3.settings.ajaxUrls["/lux/companiesinformation"],{company:t},"asynchronousCompaniesInformationLoadingCallback",{element:e})})}),s=(this.asynchronousCompaniesInformationLoadingCallback=function(e,t){t=t.element;t.innerHTML=e.numberOfVisits,t.closest("tr").querySelector("[data-lux-getcompaniesinformation-numberofvisitors]").innerHTML=e.numberOfVisitors},function(){var e=document.querySelector('[data-lux-getoverallleads="source"]'),t=document.querySelector('[data-lux-getoverallleads="target"]');null!==e&&null!==t&&h(TYPO3.settings.ajaxUrls["/lux/overallleads"],{},"asynchronousAnythingAmountLoadingCallback",{elementSource:e,elementTarget:t})}),d=function(){var e=document.querySelector('[data-lux-getoverallcompanies="source"]'),t=document.querySelector('[data-lux-getoverallcompanies="target"]');null!==e&&null!==t&&h(TYPO3.settings.ajaxUrls["/lux/overallcompanies"],{},"asynchronousAnythingAmountLoadingCallback",{elementSource:e,elementTarget:t})},m=(this.asynchronousAnythingAmountLoadingCallback=function(e,t){t.elementSource.innerHTML<e.amount&&(t.elementTarget.innerHTML=e.amountLabel)},function(){document.querySelectorAll("[data-lux-action-toggleaction]").forEach(function(e){e.addEventListener("click",function(e){e=e.currentTarget.getAttribute("data-lux-action-toggleaction");document.querySelectorAll('[data-lux-action-togglecontainer="'+e+'"]').forEach(function(e){e.classList.toggle("hidden")})})})}),g=function(){document.querySelectorAll("[data-lux-unitajax]").forEach(function(n){var e,t=new URLSearchParams;for(e in t.append("path",n.getAttribute("data-lux-unitajax")),n.dataset)0===e.indexOf("luxUnitajaxParameter")&&t.append("arguments["+e.substring("luxUnitajaxParameter".length).toLowerCase()+"]",n.dataset[e]);fetch(TYPO3.settings.ajaxUrls["/lux/unitajax"]+"&"+t).then(e=>e.text()).then(function(e){var t=n.parentNode;t.innerHTML=e,window.LuxDiagramObject.initialize(t),null!==t.querySelector("[data-lux-toggle]")&&window.LuxPageOverviewObject.initialize(t),r(t)}).catch(function(e){console.log(e)})})},x=function(){document.querySelectorAll("[data-lux-changesubmit]").forEach(function(e){e.addEventListener("change",e=>{e.target.form.submit()})})},f=function(){document.querySelectorAll('[data-lux-rangelabel="field"]').forEach(function(e){e.addEventListener("change",e=>{e.target.parentNode.querySelector('[data-lux-rangelabel="container"]').innerHTML=e.target.value})})},v=function(){document.querySelectorAll("[data-lux-historyback]").forEach(function(e){e.addEventListener("click",e=>{window.history.back()})})};var y=function(e,t){for(var n=0;n<e.length;n++)e[n].classList.remove(t)},h=function(e,t,n,a){var i;a=a||{},void 0!==e&&""!==e?((i=new XMLHttpRequest).onreadystatechange=function(){4===this.readyState&&200===this.status&&null!==n&&l[n](JSON.parse(this.responseText),a)},i.open("POST",p(e,t),!0),i.send()):console.log("No ajax URI given!")},p=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(-1!==e.indexOf("?")?e+="&":e+="?",e+=n+"="+encodeURIComponent(t[n]));return e}};var LuxBackendObject=new LuxBackend;LuxBackendObject.initialize();