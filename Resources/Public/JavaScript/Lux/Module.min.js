define(["jquery"],function(t){"use strict";function e(t){var l=this,e=(this.initialize=function(){e("leadlistdetail","visitor"),e("companydetail","company"),e("analysiscontentdetailpage","page"),e("analysisnewsdetailpage","news"),e("analysisutmdetailpage","visitor"),e("analysissearchdetailpage","searchterm"),e("analysiscontentdetaildownload","download"),e("analysislinklistenerdetail","linkListener"),e("workflowdetail","workflow","luxenterprise"),e("abtestingdetail","abTesting","luxenterprise"),e("workflowurlshortenerdetail","urlShortener","luxenterprise"),n(),a(),i(),o(),r(),c(),u(),s(),d(),m()},function(e,n,a){a=a||"lux";for(var i=document.querySelectorAll("[data-lux-action-"+e+"]"),t=0;t<i.length;t++)i[t].addEventListener("click",function(){g(i,"lux-action-detail"),this.classList.add("lux-action-detail");var t={};t[n]=this.getAttribute("data-lux-action-"+e),f(TYPO3.settings.ajaxUrls["/"+a+"/"+e],t,"generalDetailCallback")})}),n=function(){var t=document.querySelector('[data-lux-container="detail"]');null!==t&&t.addEventListener("click",function(t){t=t.target;if(null!==t.getAttribute("data-lux-description")){t.classList.contains("lux-textarea__default")&&(t.classList.remove("lux-textarea__default"),t.value="");const[e,n]=t.getAttribute("data-lux-description").split(":");t.addEventListener("blur",function(){"visitor"===e&&f(TYPO3.settings.ajaxUrls["/lux/visitordescription"],{visitor:n,value:this.value},null),"company"===e&&f(TYPO3.settings.ajaxUrls["/lux/companydescription"],{company:n,value:this.value},null)})}})},a=function(){var e,t=document.querySelector("[data-lux-visitor-company]");null!==t&&(e=t.getAttribute("data-lux-visitor-company"),t.addEventListener("change",function(t){f(TYPO3.settings.ajaxUrls["/lux/visitorcompany"],{visitor:e,value:this.value},"reloadCallback")}))},i=function(){var e,t=document.querySelector("[data-lux-company-category]");null!==t&&(e=t.getAttribute("data-lux-company-category"),t.addEventListener("change",function(t){f(TYPO3.settings.ajaxUrls["/lux/companycategory"],{company:e,value:this.value})}))},o=(this.reloadCallback=function(t){location.reload()},function(){var t=document.querySelector('[data-lux-container="detail"]');null!==t&&t.addEventListener("click",function(t){var t=t.target;null!==t.getAttribute("data-lux-linkmock-event")&&(t=t.getAttribute("data-lux-linkmock-event"),null!==(t=document.querySelector('[data-lux-linkmock-link="'+t+'"]')))&&t.click()})}),r=(this.generalDetailCallback=function(t){document.querySelector('[data-lux-container="detail"]').innerHTML=t.html,c(),a(),i(),window.LuxDiagramObject.initialize()},function(){for(var t=document.querySelectorAll("[data-lux-confirm]"),e=0;e<t.length;e++)t[e].addEventListener("click",function(t){var e=t.currentTarget.getAttribute("data-lux-confirm");!1===confirm(e)&&t.preventDefault()})});const c=function(){var e=document.querySelectorAll("[data-lux-asynchronous-image],[data-lux-asynchronous-companyimage]");for(let t=0;t<e.length;t++){var n=e[t].getAttribute("data-lux-asynchronous-image"),n=(null!==n&&f(TYPO3.settings.ajaxUrls["/lux/visitorimage"],{visitor:n},"asynchronousImageLoadingCallback",{element:e[t]}),e[t].getAttribute("data-lux-asynchronous-companyimage"));null!==n&&f(TYPO3.settings.ajaxUrls["/lux/companyimage"],{company:n},"asynchronousImageLoadingCallback",{element:e[t]})}},u=(this.asynchronousImageLoadingCallback=function(t,e){e.element instanceof HTMLImageElement&&e.element.setAttribute("src",t.url)},function(){document.querySelectorAll("[data-lux-getlinklistenerperformance]").forEach(function(t){var e=t.getAttribute("data-lux-getlinklistenerperformance");0<e&&f(TYPO3.settings.ajaxUrls["/lux/linklistenerperformance"],{linkListener:e},"asynchronousLinkListenerPerformanceLoadingCallback",{element:t})})}),s=(this.asynchronousLinkListenerPerformanceLoadingCallback=function(t,e){t=(100*t.performance).toFixed(1);e.element.innerHTML=t+" %"},function(){document.querySelectorAll("[data-lux-getcompaniesinformation-numberofvisits]").forEach(function(t){var e=t.getAttribute("data-lux-getcompaniesinformation-numberofvisits");0<e&&f(TYPO3.settings.ajaxUrls["/lux/companiesinformation"],{company:e},"asynchronousCompaniesInformationLoadingCallback",{element:t})})}),d=(this.asynchronousCompaniesInformationLoadingCallback=function(t,e){e=e.element;e.innerHTML=t.numberOfVisits,e.closest("tr").querySelector("[data-lux-getcompaniesinformation-numberofvisitors]").innerHTML=t.numberOfVisitors},function(){document.querySelectorAll("[data-lux-action-toggleaction]").forEach(function(t){t.addEventListener("click",function(t){t=t.currentTarget.getAttribute("data-lux-action-toggleaction");document.querySelectorAll('[data-lux-action-togglecontainer="'+t+'"]').forEach(function(t){t.classList.toggle("hidden")})})})}),m=function(){document.querySelectorAll("[data-lux-unitajax]").forEach(function(e){e.classList.add("luxspinner","luxspinner--center");var t=new URLSearchParams;t.append("path",e.getAttribute("data-lux-unitajax")),fetch(TYPO3.settings.ajaxUrls["/lux/unitajax"]+"&"+t).then(t=>t.text()).then(function(t){e.innerHTML=t,window.LuxDiagramObject.initialize(e)}).catch(function(t){console.log(t)}).finally(()=>{e.classList.remove("luxspinner","luxspinner--center")})})};var g=function(t,e){for(var n=0;n<t.length;n++)t[n].classList.remove(e)},f=function(t,e,n,a){var i;a=a||{},void 0!==t&&""!==t?((i=new XMLHttpRequest).onreadystatechange=function(){4===this.readyState&&200===this.status&&null!==n&&l[n](JSON.parse(this.responseText),a)},i.open("POST",x(t,e),!0),i.send()):console.log("No ajax URI given!")},x=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(-1!==t.indexOf("?")?t+="&":t+="?",t+=n+"="+encodeURIComponent(e[n]));return t}}t(document).ready(function(){(new e).initialize()})});